<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Enhanced Todo List</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 500px;
    margin: 30px auto;
  }
  h1 {
    text-align: center;
  }
  input[type="text"], #search {
    width: 100%;
    padding: 10px;
    margin: 10px 0 20px;
    box-sizing: border-box;
  }
  ul {
    list-style-type: none;
    padding-left: 0;
  }
  li {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
    background: #f9f9f9;
    padding: 8px;
    border-radius: 4px;
  }
  li.completed span {
    text-decoration: line-through;
    color: gray;
  }
  li span {
    flex-grow: 1;
    cursor: pointer;
  }
  button.remove-btn {
    background: #e74c3c;
    border: none;
    color: white;
    padding: 6px 10px;
    border-radius: 4px;
    cursor: pointer;
  }
  button.remove-btn:hover {
    background: #c0392b;
  }
</style>
</head>
<body>

<h1>Todo List</h1>

<input type="text" id="newTaskInput" placeholder="Add a new task and press Enter" />
<input type="text" id="search" placeholder="Search tasks..." />

<ul id="taskList"></ul>

<script>
  const newTaskInput = document.getElementById('newTaskInput');
  const taskList = document.getElementById('taskList');
  const searchInput = document.getElementById('search');

  // Load tasks from localStorage or initialize empty array
  let tasks = JSON.parse(localStorage.getItem('tasks')) || [];

  // Generate unique ID (simple timestamp based)
  function generateId() {
    return Date.now().toString() + Math.random().toString(36).substr(2, 5);
  }

  // Save tasks array to localStorage
  function saveTasks() {
    localStorage.setItem('tasks', JSON.stringify(tasks));
  }

  // Render tasks based on search filter
  function renderTasks(filter = '') {
    taskList.innerHTML = '';
    const filteredTasks = tasks.filter(task =>
      task.text.toLowerCase().includes(filter.toLowerCase())
    );

    filteredTasks.forEach(task => {
      const li = document.createElement('li');
      li.className = task.completed ? 'completed' : '';

      // Task text span, toggles completion on click
      const span = document.createElement('span');
      span.textContent = task.text;
      span.addEventListener('click', () => {
        task.completed = !task.completed;
        saveTasks();
        renderTasks(searchInput.value);
      });

      // Remove button
      const removeBtn = document.createElement('button');
      removeBtn.textContent = 'Remove';
      removeBtn.className = 'remove-btn';
      removeBtn.addEventListener('click', () => {
        tasks = tasks.filter(t => t.id !== task.id);
        saveTasks();
        renderTasks(searchInput.value);
      });

      li.appendChild(span);
      li.appendChild(removeBtn);
      taskList.appendChild(li);
    });
  }

  // Add new task on Enter keypress
  newTaskInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && newTaskInput.value.trim() !== '') {
      const newTask = {
        id: generateId(),
        text: newTaskInput.value.trim(),
        completed: false
      };
      tasks.push(newTask);
      saveTasks();
      renderTasks(searchInput.value);
      newTaskInput.value = '';
    }
  });

  // Search tasks in real time
  searchInput.addEventListener('input', () => {
    renderTasks(searchInput.value);
  });

  // Initial render of tasks
  renderTasks();
</script>

</body>
</html>
